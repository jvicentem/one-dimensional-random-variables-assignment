---
title: "Práctica Variable Aleatoria unidimensional"
author: "Emilio López Cano"
date: "21 de octubre de 2016"
output: 
  html_document: 
  css: style.css
theme: spacelab
---
  
## Descuentos
  
Una empresa de servicios de Internet quiere hacer una campaña para aplicar entre un 5% y un 25% de
descuento a sus clientes de forma aleatoria y lineal, y entonces la probabilidad de que un cliente reciba un
determinado descuento se puede modelizar mediante la siguiente función de densidad:

$$ \begin{cases}k(25 - x) & 5\leq x \leq25\\0 & resto\end{cases} $$

Responde a las siguientes cuestiones:
```{r, message=FALSE, warning=FALSE}
# Importamos bibliotecas
#install.packages("Ryacas")

library(Ryacas)
```

1. Calcula *k* para que *f(x)* sea realmente una función de densidad.

Primero, vamos a definir la variable aleatoria *X* como *X: Porcentaje de descuento que puede obtener un cliente (en tantos por ciento)*. *X* es una variable aleatoria continua cuyos valores están comprendidos en el intervalo [5, 25].


Para calcular el parámetro *k* he hecho uso de la librería Ryacas que permite utilizar la sintaxis YACAS para realizar cálculos matemáticos.

Hemos tenido en cuenta que para que *f(x)* sea una función de densidad es necesario que se cumpla que $$ \int_{-\infty}^{\infty} f(x)dx = 1 $$, por lo tanto obtendremos *k* a partir de esa condición.

Desarrollando:

$$ \int_{-\infty}^{\infty} f(x)dx =  \int_{-\infty}^{5} f(x)dx + \int_{5}^{25} f(x)dx + \int_{25}^{\infty} f(x)dx $$

Sustituyendo *f(x)* por el valor que le corresponde en función del intervalo:
$$ \int_{-\infty}^{5} 0·dx + \int_{5}^{25} k(25 - x)·dx + \int_{25}^{\infty} 0·dx = 0 + \int_{5}^{25} k(25 - x)·dx + 0 = \int_{5}^{25} k(25 - x)·dx $$

Igualamos a 1 para despejar *k* ya que es la condición necesaria para que *f(x)* sea una función de densidad:
$$ \int_{5}^{25} k(25 - x)·dx = 1 $$

Resolviendo la integral e igualando a 1:
$$ \left [ -k·(\frac{x²}{2}-25x)  \right ]_5^{25}=1 $$
```{r, warning=FALSE}
yacas("Solve((Integrate(x, 5, 25) k*(25-x)) == 1, k)")
```

```{r, warning=FALSE}
f <- function(x){ 
  if (x >= 5 & x <= 25) {
    return((1/200)*(25 - x))
  }
  else {
    return(0)
  }
}
```

Obtenemos que $k = \frac{1}{200}$. Además, con ese valor de *k* también se cumple que $f(x) \gt 0$, condición también necesaria para que *f(x)* sea una función de densidad.

Aprovechando que tenemos la función de densidad, podemos calcular la función de distribución, ya que $f(x) = F'(x)$.

```{r, warning=FALSE}
yacas("Integrate(x) (1/200)*(25-x)")
```

La función de distribución resulta:
$$ F(x) = \int_{}^{} \frac{1}{200}·(25 - x) dx = \frac{x}{8} - \frac{x²}{400}  $$ 

```{r, warning=FALSE}
F <- function(x){ 
  if (x >= 5 & x <= 25) {
    return((x/8) - ((x*x)/400))
  }
  else {
    return(0)
  }
}
```

```{r, warning=FALSE}
h <- Vectorize(f); curve(h, from=3, to=28)

g <- Vectorize(F); curve(g, from=3, to=28)
```

2. Calcula la probabilidad de que un cliente obtenga más de un 20% de descuento

$$ \int_{20}^{\infty} \frac{1}{200}·(25 - x) dx = \int_{20}^{25} \frac{1}{200}·(25 - x) dx  + \int_{25}^{\infty} 0 dx=  \left [ \frac{x}{8} - \frac{x²}{400}  \right ]_{20}^{25} = \frac{1}{16} = 0.0625$$

```{r, warning=FALSE}
yacas("Integrate(x, 20, 25) (1/200)*(25-x)")
```

La probabilidad de un cliente obtenga más de un 20% de descuento es 0.0625 (6.25%)


3. ¿Cuál es el descuento medio que se espera aplicar?

En las variables aleatorias continuas la esperanza matemática se define de la siguiente manera: 

$$ \mu = E(X) = \int_{-\infty}^{\infty} x·f(x)dx $$

Desarrollando lo anterior: $$ \mu = \int_{-\infty}^{\infty} x·f(x)dx = \int_{-\infty}^{5} x·0dx + \int_{5}^{25} x·\frac{1}{200}·(25 - x)dx + \int_{25}^{\infty} x·0dx = \left [ \frac{x²}{16} - \frac{x³}{600}  \right ]_{20}^{25} = \frac{35}{3} =0.0625  $$
  
```{r, warning=FALSE}
yacas("Integrate(x, 5, 25) x*((1/200)*(25-x))")
```

El descuento medio que se espera aplicar es de 11.66667%.

Es decir $\mu = \frac{35}{3}$


4. Calcula la varianza de la variable aleatoria

$$ \sigma ^{2} = V(x) = E[X^{2}] - [E(X)]^{2} = \int_{-\infty}^{\infty} x^2 f(x) dx- \mu² $$

Desarrollando lo anterior:

$$ \int_{-\infty}^{\infty} x^2 f(x) dx- \mu² = \int_{-\infty}^{\infty} x^2 f(x) dx- (\frac {35}{3})² = \int_{-\infty}^{5} x^2 0 dx- (\frac {35}{3})² + \int_{5}^{25} x^2 ·\frac{1}{200}·(25 - x)· dx- (\frac {35}{3})² + \int_{25}^{\infty} x^2 0 dx- (\frac {35}{3})² = \left [ \frac{x^{4}}{800} - \frac{x³}{24}  \right ]_{20}^{25} = \frac{475}{3} = 158.3333 $$

```{r, warning=FALSE}
yacas("Integrate(x, 5, 25) (x^2)*((1/200)*(25-x))")
```

La varianza es de 158.3333

Es decir $\sigma^2 = \frac{475}{3}$


5. ¿Entre qué valores estarán probablemente la mitad de los descuentos realizados?
```{r, warning=FALSE}

```
6. ¿Cuál es la moda de la variable aleatoria?
```{r, warning=FALSE}

```
7. Calcula la mediana de la variable aleatoria
```{r, warning=FALSE}

```

## Conclusiones
http://www.di.fc.ul.pt/~jpn/r/symbolic/
http://yacas.readthedocs.io/en/latest/index.html

https://www.codecogs.com/latex/eqneditor.php
http://www.hostmath.com/